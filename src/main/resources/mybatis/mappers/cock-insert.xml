<?xml version="1.0" encoding="UTF-8" ?>
<!DOCTYPE mapper
  PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN"
  "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="cockInsert">
	
	<select id="selectRest" parameterType="int" resultType="restVO">
		SELECT *
		  FROM cc_rest
		 WHERE rid=#{rid}
	</select>
	
	<select id="selectArticles" parameterType="int" resultType="articleVO">
		SELECT *
		  FROM cc_article
		 WHERE rid=#{rid}
	  ORDER BY article_id
	</select>
	
	<select id="selectArticle" parameterType="articleVO" resultType="articleVO">
		SELECT *
		  FROM cc_article
		 WHERE rid=#{rid} and article_id=#{articleId}
	</select>
	
	<select id="selectMenus" parameterType="articleVO" resultType="menuVO">
		SELECT *
		  FROM cc_menu
		 WHERE rid=#{rid} and article_id=#{articleId}
	  ORDER BY id
	</select>
	
	<select id="selectTags" parameterType="articleVO" resultType="tagVO">
		SELECT *
		  FROM cc_tag
		 WHERE rid=#{rid} and article_id=#{articleId}
	  ORDER BY tag_id
	</select>
	 
	<select id="selectImgs" parameterType="articleVO" resultType="imgVO">
		SELECT *
		  FROM cc_img
		 WHERE rid=#{rid} and article_id=#{articleId}
	  ORDER BY img_id
	</select>
	
	<select id="generateMaxRid" resultType="int">
		SELECT MAX(rid) + 1
		  FROM cc_rest
	</select>
	
	<select id="generateMaxAid" parameterType="int" resultType="int">
		SELECT MAX(article_id) + 1
		  FROM cc_article
		 WHERE rid=#{rid}
	</select>
	
	<insert id="insertRest" parameterType="restVO">
		INSERT INTO cc_rest
			(rid, name, lat, lng, status)
		VALUES
			(#{rid}, #{name}, #{lat}, #{lng}, #{status});
	</insert>
	
	<insert id="replaceArticle" parameterType="articleVO">
		REPLACE INTO cc_article
			(article_id, rid, comment, status, likes, hate, write_dt, uid)
		 VALUES
			(#{articleId}, #{rid}, #{comment}, #{status}, #{likes}, #{hate}, NOW(), #{uid})
	</insert>
	
</mapper>